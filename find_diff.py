#! /usr/bin/python3

'''             Verify         	     '''

'''             totals         	     '''
'''             expiry               '''
'''             prev_totals          '''

import datetime
import collections

totals = {

9500: [1042.7, 1021.9, 1047.0, 1059.8, 989.0, 925.5, 939.2, 902.9, 852.7, 806.3, 735.2, 811.3, 857.5, 878.2, 909.1, 917.9, 921.4, 958.6, 967.0, 924.0, 907.9, 790.9],
9600: [839.6, 927.7, 947.8, 996.2, 891.4, 828.6, 816.5, 812.2, 748.8, 747.5, 644.5, 719.8, 802.8, 801.4, 809.9, 820.1, 797.8, 859.6, 873.5, 828.8, 807.4, 694.6],
9700: [859.9, 839.5, 865.9, 888.8, 802.1, 740.5, 750.8, 730.2, 674.8, 639.6, 564.2, 632.9, 673.5, 691.2, 719.0, 734.5, 733.9, 769.8, 776.2, 737.5, 719.3, 607.1],
9800: [782.4, 763.5, 774.6, 797.1, 722.2, 677.6, 666.8, 619.0, 595.8, 559.6, 504.4, 559.5, 595.9, 608.9, 641.3, 650.7, 650.0, 682.5, 686.9, 646.9, 637.5, 526.2],
9900: [701.1, 680.5, 692.9, 714.3, 646.6, 599.3, 591.0, 565.0, 526.4, 487.1, 436.2, 478.2, 523.3, 525.4, 560.9, 569.4, 566.4, 600.5, 597.6, 562.0, 548.1, 446.2],
10000: [622.2, 604.4, 624.8, 628.6, 577.4, 530.1, 517.1, 497.5, 464.6, 433.2, 390.8, 420.9, 460.3, 456.2, 484.5, 495.6, 488.4, 517.1, 514.5, 481.6, 471.4, 380.2],
10100: [550.3, 527.2, 541.3, 545.0, 498.8, 458.4, 449.2, 431.8, 414.4, 379.5, 351.1, 357.0, 385.9, 390.8, 411.1, 420.4, 417.3, 440.2, 432.9, 405.8, 388.8, 321.6],
10200: [482.1, 459.4, 474.5, 476.8, 441.4, 409.3, 398.3, 388.2, 369.6, 346.2, 330.8, 326.3, 342.9, 345.5, 359.4, 364.5, 361.2, 377.4, 365.8, 341.1, 324.6, 280.1],
10300: [422.9, 402.3, 414.6, 416.8, 391.7, 363.9, 357.6, 356.4, 346.6, 328.1, 334.4, 308.9, 318.2, 315.2, 323.3, 328.4, 322.3, 328.7, 315.3, 293.6, 282.4, 262.8],
10400: [381.9, 366.9, 368.5, 373.2, 358.5, 343.9, 336.2, 334.4, 342.9, 337.2, 358.0, 315.8, 312.2, 311.4, 308.6, 310.6, 301.1, 298.8, 283.6, 269.7, 262.2, 273.6],
10500: [357.5, 349.8, 342.5, 348.4, 347.8, 345.6, 340.4, 343.2, 363.5, 368.1, 404.6, 349.9, 330.1, 325.9, 318.4, 315.8, 304.4, 290.4, 270.4, 267.7, 268.4, 308.5],
10600: [350.0, 347.8, 334.6, 337.3, 355.6, 368.8, 356.9, 364.3, 402.7, 413.8, 466.3, 398.5, 366.7, 360.3, 344.6, 341.9, 329.4, 307.9, 286.8, 295.6, 298.8, 365.1],
10700: [363.9, 365.2, 353.4, 349.7, 385.1, 408.8, 406.6, 410.3, 452.1, 473.3, 541.4, 460.9, 421.9, 400.7, 391.1, 387.4, 374.6, 344.4, 327.1, 343.2, 356.2, 441.0],
10800: [399.9, 407.0, 384.2, 387.5, 442.6, 475.2, 484.7, 517.9, 514.5, 509.6, 632.0, 594.9, 481.3, 485.6, 458.4, 469.8, 428.2, 407.2, 386.8, 411.1, 426.1, 522.8],
10900: [550.1, 546.2, 548.0, 458.8, 486.0, 537.9, 537.0, 533.2, 530.4, 527.3, 524.0, 525.7, 530.3, 532.1, 515.4, 514.8, 563.6, 466.9, 468.6, 495.7, 508.9, 609.6],

}

expiry_dates = ['26-Oct-2017', '30-Nov-2017', '28-Dec-2017']
expiry = expiry_dates[2]

sep_last_tot_oct_exp = {
  9500: 370.2,  9600: 310.3,  9700: 263.2,  9800: 238.9,  9900: 239.6,  10000: 273.1,  10100: 330.2,  10200: 410.5,  10300: 494.9,  10400: 599.3,  10500: 692.8,  10600: 801.8,  10700: 868.0,  10800: 982.8,  10900: 1080.8,
}

sep_last_tot_nov_exp = {
  9500: 481.8,  9600: 435.4,  9700: 389.5,  9800: 367.1,  9900: 361.9,  10000: 372.8,  10100: 405.8,  10200: 452.3,  10300: 511.2,  10400: 613.9,  10500: 674.5,  10600: 609.6,  10700: 686.1,  10800: 767.2,  10900: 853.8,
}

oct_last_tot_nov_exp = {
  9500: 869.8,  9600: 778.5,  9700: 686.6,  9800: 603.9,  9900: 519.2,  10000: 442.4,  10100: 372.6,  10200: 319.0,  10300: 278.2,  10400: 259.8,  10500: 266.4,  10600: 303.4,  10700: 364.1,  10800: 440.4,  10900: 524.7,
}

oct_last_tot_dec_exp = {
  9500: 941.7,  9600: 845.1,  9700: 774.6,  9800: 688.3,  9900: 611.2,  10000: 548.1,  10100: 484.2,  10200: 431.8,  10300: 388.9,  10400: 363.8,  10500: 361.1,  10600: 377.0,  10700: 410.7,  10800: 463.7,  10900: 536.0,
}

dict = {}
prev_totals = oct_last_tot_dec_exp

ordered_totals = collections.OrderedDict(sorted(totals.items()))

for k,v in ordered_totals.items():

	diff = []

	if k in prev_totals:
		prev_tot = prev_totals[k]
	else:
		prev_tot = 0

	for i in range(0, len(v)):

		df = round((v[i] - prev_tot),1)
		diff.append(df)
		prev_tot = v[i]

	dict[k] = diff

ordered_dict = collections.OrderedDict(sorted(dict.items()))

print("\nDiffs for Expiry: %s\n" % expiry) 

for key, vals in ordered_dict.items():
	print("%s => %s" % (key, vals))

print("\nRecords: ", len(vals))
print()

