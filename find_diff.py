#! /usr/bin/python3

'''             Verify         	     '''

'''             dates          	     '''
'''             closes         	     '''
'''             totals         	     '''
'''             expiry               '''
'''             date_ranges          '''

import collections

dates = ['20171101', '20171102', '20171103', '20171106', '20171107', '20171108', '20171109', '20171110', '20171113', '20171114', '20171115', '20171116', '20171117', '20171120', '20171121', '20171122', '20171123', '20171124', '20171127', '20171128', '20171129', '20171130']

closes = ['10440.5', '10423.8', '10452.5', '10451.8', '10350.15', '10303.15', '10308.95', '10321.75', '10224.95', '10186.6', '10118.05', '10214.75', '10283.6', '10298.75', '10326.9', '10342.3', '10348.75', '10389.7', '10399.55', '10370.25', '10361.3', '10226.55']

totals = {

9500: [1042.7, 1021.9, 1047.0, 1059.8, 989.0, 925.5, 939.2, 902.9, 852.7, 806.3, 735.2, 811.3, 857.5, 878.2, 909.1, 917.9, 921.4, 958.6, 967.0, 924.0, 907.9, 790.9],
9600: [839.6, 927.7, 947.8, 996.2, 891.4, 828.6, 816.5, 812.2, 748.8, 747.5, 644.5, 719.8, 802.8, 801.4, 809.9, 820.1, 797.8, 859.6, 873.5, 828.8, 807.4, 694.6],
9700: [859.9, 839.5, 865.9, 888.8, 802.1, 740.5, 750.8, 730.2, 674.8, 639.6, 564.2, 632.9, 673.5, 691.2, 719.0, 734.5, 733.9, 769.8, 776.2, 737.5, 719.3, 607.1],
9800: [782.4, 763.5, 774.6, 797.1, 722.2, 677.6, 666.8, 619.0, 595.8, 559.6, 504.4, 559.5, 595.9, 608.9, 641.3, 650.7, 650.0, 682.5, 686.9, 646.9, 637.5, 526.2],
9900: [701.1, 680.5, 692.9, 714.3, 646.6, 599.3, 591.0, 565.0, 526.4, 487.1, 436.2, 478.2, 523.3, 525.4, 560.9, 569.4, 566.4, 600.5, 597.6, 562.0, 548.1, 446.2],
10000: [622.2, 604.4, 624.8, 628.6, 577.4, 530.1, 517.1, 497.5, 464.6, 433.2, 390.8, 420.9, 460.3, 456.2, 484.5, 495.6, 488.4, 517.1, 514.5, 481.6, 471.4, 380.2],
10100: [550.3, 527.2, 541.3, 545.0, 498.8, 458.4, 449.2, 431.8, 414.4, 379.5, 351.1, 357.0, 385.9, 390.8, 411.1, 420.4, 417.3, 440.2, 432.9, 405.8, 388.8, 321.6],
10200: [482.1, 459.4, 474.5, 476.8, 441.4, 409.3, 398.3, 388.2, 369.6, 346.2, 330.8, 326.3, 342.9, 345.5, 359.4, 364.5, 361.2, 377.4, 365.8, 341.1, 324.6, 280.1],
10300: [422.9, 402.3, 414.6, 416.8, 391.7, 363.9, 357.6, 356.4, 346.6, 328.1, 334.4, 308.9, 318.2, 315.2, 323.3, 328.4, 322.3, 328.7, 315.3, 293.6, 282.4, 262.8],
10400: [381.9, 366.9, 368.5, 373.2, 358.5, 343.9, 336.2, 334.4, 342.9, 337.2, 358.0, 315.8, 312.2, 311.4, 308.6, 310.6, 301.1, 298.8, 283.6, 269.7, 262.2, 273.6],
10500: [357.5, 349.8, 342.5, 348.4, 347.8, 345.6, 340.4, 343.2, 363.5, 368.1, 404.6, 349.9, 330.1, 325.9, 318.4, 315.8, 304.4, 290.4, 270.4, 267.7, 268.4, 308.5],
10600: [350.0, 347.8, 334.6, 337.3, 355.6, 368.8, 356.9, 364.3, 402.7, 413.8, 466.3, 398.5, 366.7, 360.3, 344.6, 341.9, 329.4, 307.9, 286.8, 295.6, 298.8, 365.1],
10700: [363.9, 365.2, 353.4, 349.7, 385.1, 408.8, 406.6, 410.3, 452.1, 473.3, 541.4, 460.9, 421.9, 400.7, 391.1, 387.4, 374.6, 344.4, 327.1, 343.2, 356.2, 441.0],
10800: [399.9, 407.0, 384.2, 387.5, 442.6, 475.2, 484.7, 517.9, 514.5, 509.6, 632.0, 594.9, 481.3, 485.6, 458.4, 469.8, 428.2, 407.2, 386.8, 411.1, 426.1, 522.8],
10900: [550.1, 546.2, 548.0, 458.8, 486.0, 537.9, 537.0, 533.2, 530.4, 527.3, 524.0, 525.7, 530.3, 532.1, 515.4, 514.8, 563.6, 466.9, 468.6, 495.7, 508.9, 609.6],

}

expiry_dates = ['26-Oct-2017', '30-Nov-2017', '28-Dec-2017']
expiry = expiry_dates[2]

orderd_totals =  collections.OrderedDict(sorted(totals.items()))

# print("\nClose:\n\n%s" % closes)

# print("\nTotal:\n")

# for k,v in orderd_totals.items():
# 	print("%s => %s" % (k, v))

print()

date_ranges = [[('20171003', '20171010'), ('20171010', '20171019'), ('20171019', '20171031'), ('20171003', '20171031')],
		[('20171101', '20171110'), ('20171110', '20171120'), ('20171120', '20171130'), ('20171101', '20171130')],
]

date_range = date_ranges[1]

for dr in date_range:

	start_date = dr[0]
	end_date = dr[1]

	if start_date in dates:
		start_index = dates.index(start_date)

	if end_date in dates:
		end_index = dates.index(end_date)

	close_start = float(closes[start_index]) 
	close_end = float(closes[end_index])

	close_diff = close_end - close_start

	print("Diff From: %s to %s\t\tExpiry: %s" % (start_date, end_date, expiry))

	print("Nifty:\t\t%s\n" % (round(close_diff,1)))

	keys = []
	diff = []

	for k,v in orderd_totals.items():

		total_start = totals[k][start_index]
		total_end = totals[k][end_index]

		total_diff = round((total_end - total_start),1)

		keys.append(k)
		diff.append(total_diff)
		
	print("%s\n%s" % (keys, diff))
	print()


