#! /usr/bin/python3

import collections

date_nov = ['20171003', '20171004', '20171005', '20171006', '20171009', '20171010', '20171011', '20171012', '20171013', '20171016', '20171017', '20171018', '20171019', '20171023', '20171024', '20171025', '20171026', '20171027', '20171030', '20171031']

close_nov = ['9859.5', '9914.9', '9888.7', '9979.7', '9988.75', '10016.95', '9984.8', '10096.4', '10167.45', '10230.85', '10234.45', '10210.85', '10146.55', '10184.85', '10207.7', '10295.35', '10343.8', '10323.05', '10363.65', '10335.3']

total_nov = {

9500: [515.7, 538.9, 525.3, 592.4, 603.1, 612.7, 589.8, 673.9, 755.5, 802.9, 799.6, 786.2, 717.5, 747.8, 772.6, 836.1, 861.6, 857.9, 885.7, 869.8],
9600: [448.1, 481.4, 464.5, 501.8, 524.9, 530.8, 513.8, 593.7, 657.9, 709.2, 713.8, 693.8, 624.6, 662.4, 683.2, 744.4, 768.8, 765.9, 792.5, 778.5],
9700: [407.7, 415.9, 405.8, 441.0, 458.2, 464.9, 447.3, 510.7, 576.4, 628.9, 625.5, 606.6, 566.7, 574.4, 598.4, 654.9, 681.4, 676.2, 710.5, 686.6],
9800: [370.2, 383.4, 365.1, 396.4, 399.8, 401.3, 390.7, 447.4, 499.1, 547.1, 544.1, 529.8, 475.1, 503.0, 518.5, 569.0, 596.1, 587.8, 615.1, 603.9],
9900: [353.0, 347.1, 338.1, 353.5, 351.5, 345.6, 339.4, 380.4, 430.0, 468.4, 470.5, 460.8, 416.0, 428.9, 448.9, 493.8, 514.6, 508.9, 534.4, 519.2],
10000: [354.9, 334.3, 325.5, 321.0, 315.6, 310.6, 306.0, 330.9, 368.4, 402.9, 405.0, 391.8, 358.7, 373.9, 383.6, 420.2, 442.1, 432.8, 457.4, 442.4],
10100: [373.3, 345.4, 338.6, 309.3, 299.8, 288.9, 292.1, 294.0, 315.2, 338.6, 343.9, 331.9, 312.9, 321.2, 327.9, 358.1, 374.7, 369.5, 386.3, 372.6],
10200: [416.1, 366.9, 367.4, 323.6, 307.4, 294.2, 306.7, 279.0, 287.9, 298.4, 300.4, 294.9, 292.1, 287.8, 292.3, 312.4, 324.1, 318.6, 330.2, 319.0],
10300: [468.3, 427.9, 421.6, 355.8, 341.2, 326.5, 343.9, 293.1, 277.9, 274.1, 278.6, 275.4, 293.0, 276.4, 277.8, 284.5, 286.9, 280.3, 285.4, 278.2],
10400: [541.2, 485.3, 493.2, 414.1, 397.4, 378.2, 410.4, 331.5, 298.6, 276.2, 277.6, 284.1, 325.4, 292.6, 283.9, 275.5, 268.9, 265.7, 261.4, 259.8],
10500: [618.0, 580.6, 570.8, 490.8, 472.6, 454.0, 482.6, 392.2, 340.9, 305.9, 306.7, 321.1, 383.5, 339.2, 319.4, 292.1, 277.9, 273.5, 262.4, 266.4],
10600: [610.1, 610.1, 607.1, 609.1, 608.9, 550.8, 569.3, 573.2, 583.0, 360.4, 360.6, 372.7, 447.0, 413.9, 378.6, 339.6, 312.8, 309.3, 292.4, 303.4],
10700: [686.2, 686.1, 684.3, 686.0, 685.1, 685.4, 684.2, 685.8, 459.8, 431.0, 433.1, 450.5, 530.3, 476.6, 454.7, 403.4, 373.8, 373.3, 348.8, 364.1],
10800: [767.4, 767.5, 766.6, 767.2, 766.7, 766.8, 766.1, 767.1, 769.8, 770.5, 770.6, 770.1, 768.9, 613.9, 554.8, 479.7, 451.2, 456.8, 416.4, 440.4],
10900: [852.9, 852.9, 852.7, 852.8, 853.4, 852.8, 852.4, 852.5, 854.9, 602.3, 602.4, 602.3, 602.8, 601.5, 647.5, 650.4, 535.1, 540.2, 509.9, 524.7],

}

orderd_total_nov =  collections.OrderedDict(sorted(total_nov.items()))

# print("\nClose:\n\n%s" % close_nov)

# print("\nTotal:\n")

# for k,v in orderd_total_nov.items():
# 	print("%s => %s" % (k, v))

date_ranges = [('20171003', '20171010'), ('20171010', '20171019'), ('20171019', '20171031'), ('20171003', '20171031')]

for dr in date_ranges:

	start_date = dr[0]
	end_date = dr[1]

	if start_date in date_nov:
		start_index = date_nov.index(start_date)

	if end_date in date_nov:
		end_index = date_nov.index(end_date)

	close_start = float(close_nov[start_index]) 
	close_end = float(close_nov[end_index])

	close_diff = close_end - close_start

	print("\nDiff From: %s to %s" % (start_date, end_date))

	print("\nNifty:\t\t%s\n" % (round(close_diff,1)))

	keys = []
	diff = []

	for k,v in orderd_total_nov.items():

		total_start = total_nov[k][start_index]
		total_end = total_nov[k][end_index]

		total_diff = round((total_end - total_start),1)

		keys.append(k)
		diff.append(total_diff)
		
	print("%s\n%s" % (keys, diff))
	print()


